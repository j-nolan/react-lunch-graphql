<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>reveal.js</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/black.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                  <h2>GraphQL and Apollo client</h2>
                  <img src="http://graphql.nodaljs.com/static/images/graphql_logo.png" style="height: 300px; border: 0">
                  <img src="https://pbs.twimg.com/profile_images/842844018606186496/HwAymj6H.jpg" style="height: 300px; border: 0">
                  <img src="https://pblackops.github.io/react/images/react.png" style="height: 300px; border: 0">
                  <p>ReactJS Lunch @ CHILI lab, EPFL</p>

                  <p>May 29th, 2017</p>
                </section>
                <section>
                  <h2>About myself</h2>
                  <ul>
                    <li>James Nolan</li>
                    <li>"Full stack" software engineer @ <a href="https://coteries.com/">coteries &bull; Lab</a></li>
                    <li>JavaScript, React</li>
                    <li>Twitter <a href="https://twitter.com/CoffeeHeadJim">@CoffeeHeadJim</a></li>
                    <li><a href="mailto:j.nolan@otherwise.ch">j.nolan@otherwise.ch</a></li>
                  </ul>
                </section>
                <section>
                    <h2>History</h2>
                      <section>
                        <ul>
                          <li>2012, Facebook redesigns app after HTML5 fiasco</li>
                          <li><strong>"What would an ideal API look like?"</strong></li>
                        </ul>
                        <aside class="notes">
                          <ul>
                            <li>in 2012 Facebook released its mobile app</li>
                            <li>the app was built in html5</li>
                            <li>bad response from user. Laggy feeling</li>
                            <li>they decided to completely redesign the app in the native environment</li>
                            <li>at the time, Facebook was a "simple" PHP website. Serverside rendered. Move fast, break things. Everybody could see new releases instantly. No need to have an API layer, no need for maintaining endpoints, They wanted to keep that speed</li>
                            <li>one of the main question that came up was "What would an ideal API look like?"</li>
                            <li>and they built graphql</li>
                            <li>conclusion: graphql was built for native apps by web developers</li>
                            <li>this may be graphql popularity in web apps today</li>
                          </ul>
                        </aside>
                    </section>
                    <section>
                      <ul>
                        <li>Since then, GraphQL powers the Android and iOS Facebook apps</li>
                        <li>300 billion+ requests per day at Facebook</li>
                        <li>2015, open sourced</li>
                      </ul>
                      <aside class="notes">
                        <ul>
                          <li>in 2012 Facebook released its mobile app</li>
                          <li>the app was built in html5</li>
                          <li>bad response from user. Laggy feeling</li>
                          <li>they decided to completely redesign the app in the native environment</li>
                          <li>at the time, Facebook was a "simple" PHP website. Serverside rendered. Move fast, break things. Everybody could see new releases instantly. No need to have an API layer, no need for maintaining endpoints, They wanted to keep that speed</li>
                          <li>one of the main question that came up was "What would an ideal API look like?"</li>
                          <li>and they built graphql</li>
                          <li>conclusion: graphql was built for native apps by web developers</li>
                          <li>this may be graphql popularity in web apps today</li>
                          <li>Since then, GraphQL powers the Android and iOS Facebook apps</li>
                          <li>300 billion+ requests per day at Facebook</li>
                          <li>This is the majority of requests</li>
                          <li>2015, GraphQL started being promoted by the React team at Facebook</li>
                          <li>Lee Byron Published <a href="https://code.facebook.com/posts/1691455094417024/graphql-a-data-query-language/">GraphQL, a data query language</a></li>
                        </ul>
                      </aside>
                  </section>
                </section>
                <section data-background-color="#ffffff">
                    <h2>Who uses it?</h2>
                    <section>
                        <img src="http://graphql.org/users/logos/20minutes.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/adayroi.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/allocine.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/alphasights.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/ants.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/appier.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/arangodb.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/artsy.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/attendify.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/bazinga.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/blenderbottle.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/brewerybuddy.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/bright.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/buildkite.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/clubmed.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/commercetools.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/coursera.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/creditkarma.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/curio.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/directlyrics.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/drift.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/duedil.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/eastview.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/easycarros.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/ediket.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/facebook.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/github.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/graphcms.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/graphcool.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/hijup.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/housinganywhere.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/hudl.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/icon-systems.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/idobata.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/indonesiax.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/inerva.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/intuit.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/leanix.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/legendsoflearning.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/lelivrescolaire.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/loggi.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/m1finance.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/make-school.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/meteor.png" style="width: 10%; border: 0; box-shadow: none">
                    </section>
                    <section>
                        <img src="http://graphql.org/users/logos/mixcloud.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/mojilala.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/newspring.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/ningensoft.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/nova-ideo.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/okgrow.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/ovos.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/persado.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/pinterest.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/product-hunt.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/project-september.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/prowl.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/quri.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/redbubble.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/reindex.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/restorando.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/salestock.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/scaphold.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/serverless.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/shopify.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/sky.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/skyarchnetworks.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/smarkets.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/startupsco.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/stem.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/swapcard.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/syzygy.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/taller.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/thehunt.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/trove.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/unigraph.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/ustglobal.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/vanilaio.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/waitlessq.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/waldo-photos.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/wayfair.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/whitescape.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/wirtualnapolska.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/wishlife.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/workflowgen.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/wowair.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/zlyde.png" style="width: 10%; border: 0; box-shadow: none">
                        <img src="http://graphql.org/users/logos/zzish.png" style="width: 10%; border: 0; box-shadow: none">
                        <aside class="notes">
                          <ul>
                            <li>20 Minutes</li>
                            <li>Club Med</li>
                            <li>Coursera</li>
                            <li>Facebook</li>
                            <li>Github</li>
                            <li>Meteor</li>
                            <li>Pinterest</li>
                            <li>Product Hunt</li>
                            <li>Shopify</li>
                            <li>Sky network</li>
                            <li>Sky network</li>
                          </ul>
                        </aside>
                    </section>
                </section>
                <section>
                    <h2>The problem with REST</h2>
                </section>
                <section>
                    <section>
                        <h3>Overfetching</h3>
                        <img src="assets/trello.gif" style="float: left; max-width: 30%">
                        <div style="float: right; width: 60%">
                            <pre><code data-trim data-noescape>
                            ⟶ GET board/123/cards
                            ⟵ 200 OK [{
                              "content": "Move static assets to CDN",
                              "collaborators": [{...}],
                              "labels": [{...}, {...}],
                              "board": {...},
                              "checklists": [{...}, {...}],
                              "createdAt": {...},
                              "updatedAt": {...},
                              "expiresAt": {...},
                              "dueDate": {...},
                              "author": {...},
                              "attachments": [{...}, {...}],
                              "activity": [{...}, {...}],
                              "webhooks": [{...}, {...}],
                            ]}
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <h3>Extra roundtrips</h3>
                        <div style="float: left; width: 60%">
                            <pre><code data-trim data-noescape>
                            ⟶ GET board/123/cards
                            ⟵ 200 OK [{
                              "content": "Move static assets to CDN",
                              "collaboratorsIds": [1308]
                            ]}

                            ⟶ GET collaborator/1308
                            ⟵ 200 OK [{
                              "name": "Manu",
                              "avatar": "https://..."
                            ]}
                            </code></pre>
                        </div>
                        <img src="assets/trello.gif" style="float: right; max-width: 30%">
                    </section>
                    <section>
                        <h3>REST's solutions</h3>
                        <ul>
                          <li>Explicit fields</li>
                          <li>Subtrees</li>
                          <li>More endpoints</li>
                        </ul>
                    </section>
                    <section>
                        <pre><code data-trim data-noescape>
                        ⟶ GET board/123/cards?include=content,labels&amp;expand=collaborators
                        ⟵ 200 OK [{
                          "content": "Move static assets to CDN",
                          "labelsIds": [99, 101],
                          "collaborators": [{...}, {...}]
                        ]}
                        </code></pre>
                        <pre><code data-trim data-noescape>
                        ⟶ GET board/123/cards
                        ⟵ 200 OK [{
                          ...
                          "collaborators": [{
                            "name": "Manu",
                            "avatar": "https://...",
                            "type": "premium",
                            "cards": [...],
                          }],
                          ...
                        ]}
                        </code></pre>
                    </section>
                    <section>
                      <h3>Hard do get right</h3>
                      <ul>
                        <li>How to enumerate fields in subtrees?</li>
                        <li>When is a subtree more relevant than a reference (ID)?</li>
                        <li>Should the backend developers maintain endpoints for each frontend view?</li>
                        <li>How to keep a reasonable number of endpoints?</li>
                        <li><strong>Why would we let the server decide what data to return?</strong></li>
                      </ul>
                    </section>
                </section>

                <section>
                  <h2>What is GraphQL?</h2>
                  <section>
                    <img src="assets/graphql-example.jpg">
                  </section>
                  <section>
                    <ul>
                      <li>Defines a data shape</li>
                      <li>Hierarchical</li>
                      <li>Strongly typed</li>
                      <li>Protocol, not storage</li>
                      <li>Introspective</li>
                    </ul>
                    <p><a href="https://code.facebook.com/posts/1691455094417024/graphql-a-data-query-language/">Lee Byron, 2015</a></p>
                    <aside class="notes">
                      <ul>
                        <li>Defines a data shape: The first thing you'll notice is that GraphQL queries mirror their response. This makes it easy to predict the shape of the data returned from a query, as well as to write a query if you know the data your app needs. More important, this makes GraphQL really easy to learn and use. GraphQL is unapologetically driven by the data requirements of products and of the designers and developers who build them.</li>
                        <li>Hierarchical: Another important aspect of GraphQL is its hierarchical nature. GraphQL naturally follows relationships between objects, where a RESTful service may require multiple round-trips (resource-intensive on mobile networks) or a complex join statement in SQL. This data hierarchy pairs well with graph-structured data stores and ultimately with the hierarchical user interfaces it's used within.</li>
                        <li>Strongly typed: Each level of a GraphQL query corresponds to a particular type, and each type describes a set of available fields. Similar to SQL, this allows GraphQL to provide descriptive error messages before executing a query.</li>
                        <li>Protocol, not storage: Each GraphQL field on the server is backed by any arbitrary function. While we were building GraphQL to support News Feed, we already had a sophisticated feed ranking and storage model, along with existing databases and business logic. GraphQL had to leverage all this existing work to be useful, and so does not dictate or provide any backing storage. Instead, GraphQL takes advantage of your existing code.</li>
                        <li>Introspective: A GraphQL server can be queried for the types it supports. This creates a powerful platform for tools and client software to build atop this information like code generation in statically typed languages, our application framework, Relay, or IDEs like GraphiQL (pictured below). GraphiQL helps developers learn and explore an API quickly without grepping the codebase or wrangling with cURL.</li>
                      </ul>
                    </aside>
                  </section>

                  <section>
                      <ul>
                        <li>Lets clients specify their own <strong>data needs</strong></li>
                        <li>Lets the server expose its own <strong>capabilities</strong></li>
                      </ul>
                    <p><a href="https://www.youtube.com/watch?v=MGHwJ-dH2Os">Martijn Walraven, 2017</a></p>
                  </section>
                </section>

                <section>
                    <section>
                      <h2>Queries</h2>
                    </section>
                    <section>
                      <a  title="simple query" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweets%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-flat.png">
                      </a>
                    </section>
                    <section>
                      <a title="Field parameters" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweets(limit%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-parameter.png">
                      </a>
                    </section>
                    <section>
                      <a title="Deep query" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweets(limit%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%20%20author%20%7B%0A%20%20%20%20%20%20name%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-deep.png">
                      </a>
                    </section>
                    <section>
                      <a title="Very deep query" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweets(limit%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%20%20author%20%7B%0A%20%20%20%20%20%20name%0A%20%20%20%20%20%20followers%20%7B%0A%20%20%20%20%20%20%20%20name%0A%20%20%20%20%20%20%20%20tweets%20%7B%0A%20%20%20%20%20%20%20%20%20%20content%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-very-deep.png">
                      </a>
                    </section>
                    <section>
                      <a title="Query without variable" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweet(id%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-no-variables.png">
                      </a>
                    </section>
                    <section>
                      <a title="Query variable" target="_blank" href="http://localhost:4000/graphql?query=query%20(%24id%3A%20ID!)%20%7B%0A%20%20tweet(id%3A%20%24id)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D%0A&variables=%7B%22id%22%3A%201%7D">
                        <img src="assets/query-variables.png">
                      </a>
                    </section>
                </section>

                <section>
                    <section>
                      <h2>Mutations</h2>
                    </section>
                    <section>
                      <a title="Query without variable" target="_blank" href="http://localhost:4000/graphql?query=query%20%7B%0A%20%20tweet(id%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D%0A">
                        <img src="assets/query-no-variables.png">
                      </a>
                    </section>
                    <section>
                      <a title="Like tweet" target="_blank" href="http://localhost:4000/graphql?query=mutation%20%7B%0A%20%20likeTweet(id%3A%201)%20%7B%0A%20%20%20%20content%0A%20%20%20%20likes%0A%20%20%7D%0A%7D">
                        <img src="assets/mutation-liketweet.png">
                      </a>
                      <aside class="notes">
                        <ul>
                          <li><a href="https://medium.com/@HurricaneJames/graphql-mutations-fb3ad5ae73c4">"The only real difference between a mutation and a query is the word mutation"</a>, James Burnett</li>
                          <li><a href="https://medium.com/@HurricaneJames/graphql-mutations-fb3ad5ae73c4">"There is nothing stopping a query from including a side effect just like a mutation."</a>, James Burnett</li>
                          <li>Clients, servers might use it for caching purpose</li>
                        </ul>
                      </aside>
                    </section>
                  </section>
                <section>
                  <section>
                    <h2>Subscriptions</h2>
                  </section>
                  <section>
                    <img src="assets/subscriptions.gif" style="width: 100%">
                  </section>
                  <section>
                    <img src="assets/subscription.png">
                    <aside class="notes">
                      <ul>
                        <li>Uses websockets</li>
                        <li>Pushes new state</li>
                        <li>Especially useful for chats, games,...</li>
                      </ul>
                    </aside>
                  </section>
                </section>
                <section>
                  <section>
                    <h2>Schema and types</h2>
                  </section>
                  <section>
                    <pre><code>
  #
  # Welcome to the MiniTwitter GraphQL API. It was built by James Nolan as a
  # demonstration for the May 29th React Lunch about GrapHQL and Apollo client
  #

  # Users can write tweets. Users have IDs that have the format of a twitter handle
  type User {

    # The ID of the user. It is in the Twitter handle format, such as @johnDoe
    id: ID

    # The name of the user. Usually first name + last name
    name: String

    # The list of users that follow that user
    followers: [User]

    # The list of tweets the user wrote
    tweets(limit: Int): [Tweet]

  }

  # A tweet typically consists in a small text and the number of people that liked it
  type Tweet {

    # The ID of a tweet. Typically a unique integer
    id: ID

     # the actual content of the tweet. Max 144 in length!
    content: String

    # the number of times the tweet has been liked
    likes: Int

    # the user that wrote the tweet
    author: User

  }

  # Queries allows the client to retrieve data from the API. GraphQL queries can be
  # compared to GET requests in REST APIs
  type Query {

    # Returns a list of all the tweets. You can optionally pass a limit parameter to
    # specify the max number of tweets the API can return
    tweets(limit: Int): [Tweet]

    # Returns a single tweet by its ID
    tweet(id: ID!): Tweet

  }

  # Mutations are similar to Queries, except that they will probably change something
  # in the data. GraphQL Mutations can be compared to POST requests in REST APIs
  type Mutation {

    # Updates the "like" count of a given tweet. You should pass the ID of the tweet
    # to update
    likeTweet(id: ID!): Tweet

  }
`
                    </code></pre>
                    <p>(view in editor)</p>
                  </section>
                  <section>
                    <h3>Scalar types</h3>
                    <ul>
                      <li><code>Int</code>: a 32-bit signed integer</li>
                      <li><code>Float</code>: A signed double-precision floating-point value</li>
                      <li><code>String</code>: A UTF‐8 character sequence</li>
                      <li><code>Boolean</code>: true or false</li>
                      <li><code>ID</code>: A unique identifier (alias of String)</li>
                      <li>Custom scalars</li>
                    </ul>
                    <aside class="notes">
                      <ul>
                        <li>Custom scalar example: Date</li>
                        <li>Custom scalar: you have to specify how to de/serialize it</li>
                      </ul>
                    </aside>
                  </section>
                  <section>
                    <h3>Enums</h3>
                    <pre><code>
enum CoffeeSize {
  Short
  Tall
  Grande
  Venti
}
                    </code></pre>
                    <pre><code>
mutation ($type: String, $size: CoffeeSize) {
  orderCoffee (type: $type, size: $size) {
    timeToWait
  }
}

# variables
{ type: "Americano", CoffeeSize: "Short" }
                    </code></pre>
                  </section>
                  <section>
                    <h3>Lists and null values</h3>
                    <pre><code>
type User {
  id: ID!
  name: String!
  followers: [User!]
}
                    </code></pre>
                  </section>
                  <section>
                    <h3>Other constructs</h3>
                    <ul>
                      <li>Interfaces</li>
                      <li>Unions</li>
                      <li>Input types</li>
                      <li>Fragments</li>
                      <li>Directives</li>
                    </ul>
                  </section>
                </section>
                <section>
                  <section>
                    <h2>Apollo</h2>
                    <p>Connecting a simple UI to a GraphQL server</p>
                  </section>
                  <section>
                    <h3>Step 0: run backend</h3>
                    <code><pre>
git clone git@github.com:j-nolan/react-lunch-graphql.git
cd react-lunch-graphql
cd server && npm install && npm start
                    </code></pre>
                  </section>
                  <section>
                    <h3>Step 1: A pure UI</h3>
                    <code>cd example-apps/01-pure-ui && npm install && npm start</code>
                    <a target="_blank" href="http://localhost:3000"><img  style="max-height: 300px" src="assets/mini-twitter.png"></a>
                  </section>
                  <section>
                    <h3>Step 2: Query Tweet</h3>
                    <code>cd example-apps/02-query-tweet && npm install && npm start</code>
                    <aside class="notes">
                      <ul>
                        <li>Demonstrates a simple query</li>
                        <li>Note how we can duplicate the tweet and graphql only performs a single query</li>
                      </ul>
                    </aside>
                  </section>
                  <section>
                    <h3>Step 3: Mutate tweet</h3>
                    <code>cd example-apps/03-mutate-tweet && npm install && npm start</code>
                    <aside class="notes">
                      <ul>
                        <li>Demonstrates a mutation</li>
                        <li>Look how it refreshes multiple components at once!</li>
                      </ul>
                    </aside>
                  </section>
                  <section>
                    <h3>Step 4: Optimistic Like Tweet</h3>
                    <code>cd example-apps/04-mutate-tweet-optimistic && npm install && npm start</code>
                    <aside class="notes">
                      <ul>
                        <li>Thottle to emphasis effect</li>
                        <li>Look how it refreshes multiple components at once!</li>
                      </ul>
                    </aside>
                  </section>
                  <section>
                    <h3>Step 5: Polling</h3>
                    <code>cd example-apps/05-polling && npm install && npm start</code>
                  </section>
                  <section>
                    <h3>(Step 6: Subscriptions)</h3>
                  </section>
                  <section>
                    <h3>(Step 7: Pagination)</h3>
                  </section>
                </section>
                <section>
                  <h2>Mini case studies</h2>

                  <section>
                    <h3>Manual store update</h3>
                    <ul>
                      <li>Apollo updates its store automatically</li>
                      <li>Uses normalization: maps {typename, id} -> object</li>
                      <li>Doesn't handle adding <i>new</i> objects to lists</li>
                    </ul>
                  </section>

                  <section>
                    <h3>Solution 1: <code>refetchQueries</code></h3>
                    <pre><code>

export default graphql(createTweetMutation, {
  props: ({ mutate }) => ({
    createTweet: (content, authorId) => mutate({
      variables: { content, authorId },
      refetchQueries: [{
        query: listTweetsQuery
      }],
    })
  })
})
                    </pre></code>
                    <aside class="notes">
                      <ul>
                        <li>Acceptable if roundtrips are not an issue</li>
                        <li>Requires to *know* about queries to refetch</li>
                      </ul>
                    </aside>
                  </section>

                  <section>
                    <h3>Solution 2: <code>update</code></h3>
                    <pre><code>

export default graphql(createTweetMutation, {
  props: ({ mutate }) => ({
    createTweet: (content, authorId) => mutate({
      variables: { content, authorId },
      update: (store, { data: { createTweet } }) => {
        const data = store.readQuery({ query: listTweets });
        data.tweets.push(createTweet);
        store.writeQuery({ query: listTweets, data });
      },
    })
  })
})
                    </pre></code>
                    <aside class="notes">
                      <ul>
                        <li>Avoids round trips</li>
                      </ul>
                    </aside>
                  </section>

                  <section>
                    <h3>Delayed queries</h3>
                    <code><pre>
&lt;App&gt;
  graphql(closestTweets)(&lt;Map /&gt;)
&lt;/App&gt;
                    </pre></code>
                    <ul>
                      <li>Query might depend on data that we can only retrieve asynchronously</li>
                      <li>In this case, <code>Geolocation.getCurrentPosition()</code></li>
                    </ul>
                  </section>

                  <section>
                    <h3>Solution 1</h3>
                    <code><pre>
&lt;App&gt;
  withApollo(&lt;Map /&gt;)
&lt;/App&gt;

/* Map.js */
export default class Map extends Component {
  /* Get location, then manually trigger query, then render query result */
}
                    </pre></code>
                    <ul>
                      <li>Solution 1: take over and make the query manually</li>
                      <li>Requires manually managing <code>loading</code> and <code>error</code> states</li>
                      <li>Mixes stateful logic inside Map UI component</li>
                    </ul>
                  </section>

                  <section>
                    <h3>Solution 2</h3>
                    <code><pre>
&lt;App&gt;
  withLocation(graphql(closestTweets)(&lt;Map /&gt;))
&lt;/App&gt;
                    </pre></code>
                    <ul>
                      <li><code>withLocation</code> Higher Order Component (HOC)</li>
                      <li>Delays rendering <Map /> until location is resolved</li>
                      <li>Reusable</li>
                    </ul>
                  </section>

                  <section>
                    <h3>Offline first</h3>
                    <ul>
                      <li>Offline mutations? Don't use Apollo (yet)</li>
                      <li>Offline queries? Use redux-persist</li>
                    </ul>
                  </section>
                </section>
                <section>
                  <h2>Tools</h2>
                  <section>
                    <h3>Graphiql</h3>
                    <ul>
                      <li>An browser GraphQL API explorer</li>
                      <li>Queries, mutation, subscriptions, variables, validation...</li>
                      <li>Dynamic documentation</li>
                      <li>Widely adopted</li>
                    </ul>
                  </section>
                  <section>
                    <h3>Lokka</h3>
                    <ul>
                      <li>Basic JS GraphQL client for browser / Node.js / React Native</li>
                      <li>Alternative to Apollo</li>
                      <li>Doesn't support variables</li>
                    </ul>
                  </section>
                  <section>
                    <h3>Apollo dev tools</h3>
                    <ul>
                      <li>Bulit-in graphiql</li>
                      <li>Easily inspect stores</li>
                    </ul>
                  </section>
                  <section>
                      <h3><a href="https://marketplace.visualstudio.com/items?itemName=kumar-harsh.graphql-for-vscode">graphql-for-vscode</a></h3>
                  </section>
                  <section>
                    <h3>Launchpad</h3>
                    <ul>
                      <li>In-browser GraphQL server playground</li>
                      <li>Instantly create public schemas</li>
                    </ul>
                  </section>
                  <section>
                    <h3>graph.cool</h3>
                    <ul>
                      <li>GraphQL Backend as a service</li>
                      <li>Organize the GraphQL Europe conference</li>
                    </ul>
                  </section>
                </section>
                <section>
                  <h2>Thanks</h2>
                  <ul>
                    <li><a href="https://twitter.com/martijnwalraven">Martijn Walraven</a></li>
                    <li><a href="https://www.meetup.com/EFPL-Reactjs-Lunch/members/190756400/">Stian Håklev</a></li>
                    <li><a href="https://twitter.com/nicedexter">Manuel Spuhler</a></li>
                  </ul>
                </section>
                <section>
                  <h2>Sources</h2>
                  <ul>
                    <li><a href="https://www.youtube.com/watch?v=MGHwJ-dH2Os">Strong typing from the server to the UI with GraphQL</a>, Martijn Walraven @ UIKonf 2017</li>
                    <li><a href="http://graphql.org/users/">Who's using GraphQL?</a></li>
                    <li><a href="https://code.facebook.com/posts/1691455094417024/graphql-a-data-query-language/">GraphQL, a data query language</a>, Lee Byron</li>
                  </ul>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info about config & dependencies:
            // - https://github.com/hakimel/reveal.js#configuration
            // - https://github.com/hakimel/reveal.js#dependencies
            Reveal.initialize({
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                ]
            });
        </script>
    </body>
</html>
